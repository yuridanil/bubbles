<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100%;
        }

        svg {
            width: 100%;
            height: 100vh;
            opacity: 1;
            cursor: none;
        }
    </style>

    <script>
        let start = new Date();
        let radius = 10;
        let canvas;
        let ctx;
        let n = 0;
        let respawn = false;
        let animate = true;
        let generate;
        let x, y;
        let
            W,
            H,
            BUBBLE_CNT = 1,
            WAVE_CNT = 1,
            DEFAULT_SIZE = 32,
            SPEED = 50,
            MIN_RADIUS = 2,
            MAX_RADIUS = 15;
        let bubbles = [];
        let waves = [];
        let svg, circle;
        let img = new Image();

        const animateBubbles = () => {
            n++;
            svg.querySelectorAll("#bubbles > circle").forEach((e, i) => {
                let cx = parseFloat(e.getAttribute("cx")),
                    cy = parseFloat(e.getAttribute("cy")),
                    dx = parseFloat(e.getAttribute("dx")),
                    r = parseFloat(e.getAttribute("r"));
                if (Math.random() < 0.01) dx = - dx;
                cx = cx + ((- 1 + 2 * Math.random()) + dx / 3) * r / 12;
                cy = cy - 5 * r / 12 * SPEED / 100;
                if (respawn && (cy < -r || cx < -r || cx > W + r)) {
                    cy = H;
                    cx = Math.floor(W * Math.random());
                }
                e.setAttribute("cx", cx);
                e.setAttribute("cy", cy);
                e.setAttribute("dx", dx);

            });
            window.requestAnimationFrame(animateBubbles);
        }

        const createBubble = (x, y, r) => {
            let bubble = document.createElementNS(svg.namespaceURI, 'circle');
            bubble.setAttribute("cx", x);
            bubble.setAttribute("cy", y);
            bubble.setAttribute("dx", Math.random() > 0.5 ? -1 : 1);
            bubble.setAttribute("r", r);
            bubble.setAttribute("fill", "#ffffff");
            bubble.setAttribute("style", "opacity:0.5; filter:drop-shadow(" + .4 * radius + "px " + .6 * radius + "px 1px #ff664488) drop-shadow(-" + .2 * radius + "px -" + .4 * radius + "px 1px #44ffffff) blur(2px)");
            svg.querySelector("#bubbles").appendChild(bubble);
        }

        const initSvg = () => {
            for (let i = 0; i < BUBBLE_CNT; i++) {
                let bubble = document.createElementNS(svg.namespaceURI, 'circle');
                createBubble(
                    Math.floor(W * Math.random()),
                    Math.floor(H * Math.random()),
                    MIN_RADIUS + (Math.random() * (MAX_RADIUS - MIN_RADIUS))
                );
            }
        }

        const resizeSvg = () => {
            W = document.body.clientWidth;
            H = document.body.clientHeight;
            svg.setAttribute("width", W);
            svg.setAttribute("height", H);
        }

        window.onresize = () => {
            resizeSvg();
        }

        window.onmousemove = (e) => {
            x = e.clientX;
            y = e.clientY;
            if (circle) {
                circle.setAttribute("cx", e.clientX - radius / 2);
                circle.setAttribute("cy", e.clientY - radius / 2);
            }
        }

        window.onmousedown = (e) => {
            if (e.which === 1) {
                createBubble(x, y, radius);
                generate = setInterval((e) => {
                    createBubble(x, y, radius);
                }, 100);
            };
        }

        window.onmouseup = (e) => {
            if (e.which === 1) {
                clearInterval(generate);
            };
        }

        window.onwheel = (e) => {
            if (e.deltaY < 0 && radius < MAX_RADIUS)
                radius++;
            else if (e.deltaY > 0 && radius > MIN_RADIUS)
                radius--;
            circle.setAttribute("r", radius);
            circle.setAttribute("cx", e.clientX - radius / 2);
            circle.setAttribute("cy", e.clientY - radius / 2);
        }

        window.onkeydown = (e) => {
            if (e.code === 'Enter') {
                if (document.fullscreenElement)
                    document.exitFullscreen();
                else
                    document.body.requestFullscreen();
            } else if (e.code === 'Backspace') {
                let bubble = svg.querySelector("#bubbles > circle");
                if (bubble)
                    bubble.remove();
            } else if (e.code === 'Delete') {
                let bubbles = svg.querySelectorAll("#bubbles > circle");
                if (bubbles)
                    bubbles.forEach(e => e.remove());
            }
        }

        window.onload = () => {
            svg = document.getElementById("svg");
            circle = document.querySelector("#circle");
            resizeSvg();
            initSvg();
            window.requestAnimationFrame(animateBubbles);
        }
    </script>
</head>

<body>
    <svg id="svg" class="svg">
        <defs>
            <linearGradient id="seaGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" stop-color="#00aacc" />
                <stop offset="100%" stop-color="#003040" />
            </linearGradient>
        </defs>
        <rect x="0" y="0" width="100%" height="100%" fill="url(#seaGradient)" />
        <g id="waves"></g>
        <g id="bubbles"></g>
        <circle id="circle" cx="10" cy="10" r="10" fill="#ffffff55" />
    </svg>

</body>

</html>